<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE devices PUBLIC "-//YARP//DTD yarprobotinterface 3.0//EN" "http://www.yarp.it/DTD/yarprobotinterfaceV3.0.dtd">

<devices robot="iCubGenova04" build="1">
    <device xmlns:xi="http://www.w3.org/2001/XInclude" name="wholebodydynamics" type="wholebodydynamics">
        <param name="axesNames">(torso_pitch,torso_roll,torso_yaw,neck_pitch, neck_roll,neck_yaw,l_shoulder_pitch,l_shoulder_roll,l_shoulder_yaw,l_elbow,r_shoulder_pitch,r_shoulder_roll,r_shoulder_yaw,r_elbow,l_hip_pitch,l_hip_roll,l_hip_yaw,l_knee,l_ankle_pitch,l_ankle_roll,r_hip_pitch,r_hip_roll,r_hip_yaw,r_knee,r_ankle_pitch,r_ankle_roll)</param>
        <param name="modelFile">model.urdf</param>
        <param name="fixedFrameGravity">(0,0,-9.81)</param>
        <param name="defaultContactFrames">(l_hand,r_hand,root_link,l_sole,r_sole,l_lower_leg,r_lower_leg,l_elbow_1,r_elbow_1)</param>
        <param name="imuFrameName">imu_frame</param>
        <param name="useJointVelocity">true</param>
        <param name="useJointAcceleration">true</param>
        <param name="streamFilteredFT">true</param>
        <param name="portPrefix">/wholeBodyDynamics_External</param>
        <group name="multipleAnalogSensorsNames">
             <param name="TemperatureSensorsNames">(l_leg_ft_sensor,r_leg_ft_sensor,l_foot_ft_sensor,r_foot_ft_sensor)</param>
             <param name="SixAxisForceTorqueSensorsNames">(l_leg_ft_sensor,r_leg_ft_sensor,l_foot_ft_sensor,r_foot_ft_sensor)</param>
        </group>


        <!-- map between iDynTree links (identified by a name)
             and skinDynLib links (identified by their frame name, a BodyPart enum
             and a local (to the body part) index -->
        <group name="IDYNTREE_SKINDYNLIB_LINKS">
            <param name="root_link">(root_link,1,0)</param>
            <param name="chest"> (chest,1,2)</param>
            <param name="l_upper_arm">(l_upper_arm,3,2)</param>
            <param name="l_elbow_1">(l_elbow_1, 3, 4)</param>
            <param name="r_upper_arm">(r_upper_arm,4,2)</param>
            <param name="r_elbow_1">(r_elbow_1, 4, 4)</param>
            <param name="l_lower_leg">(l_lower_leg,5,3)</param>
            <param name="l_ankle_1">(l_ankle_1,5,4)</param>
            <param name="l_foot">(l_foot_dh_frame,5,5)</param>
            <param name="r_lower_leg">(r_lower_leg,6,3)</param>
            <param name="r_ankle_1">(r_ankle_1,6,4)</param>
            <param name="r_foot">(r_foot_dh_frame,6,5)</param>
        </group>

        <group name="GRAVITY_COMPENSATION">
            <param name="enableGravityCompensation">true</param>
            <param name="gravityCompensationBaseLink">root_link</param>
            <param name="gravityCompensationAxesNames">(torso_pitch,torso_roll,torso_yaw,neck_pitch,neck_roll,neck_yaw,l_shoulder_pitch,l_shoulder_roll,l_shoulder_yaw,l_elbow,r_shoulder_pitch,r_shoulder_roll,r_shoulder_yaw,r_elbow)</param>
        </group>

        <group name="WBD_OUTPUT_EXTERNAL_WRENCH_PORTS">
            <param name="/wholeBodyDynamics/left_leg/cartesianEndEffectorWrench:o">(l_foot,l_sole,root_link)</param>
            <param name="/wholeBodyDynamics/right_leg/cartesianEndEffectorWrench:o">(r_foot,r_sole,root_link)</param>
        </group>

<!--<group name="FT_SECONDARY_CALIBRATION">
              <param name="l_leg_ft_sensor">(7.435322e-01,2.576539e-02,-4.352193e-02,1.623515e-01,6.701694e-01,1.338672e-01 
                                              ,2.157154e-02,5.477702e-01,8.259747e-03,-2.861963e-01,-1.111438e-01,2.345112e+00 
                                              ,-8.926765e-02,1.512053e-01,9.904328e-01,1.262080e+00,3.469018e-01,-4.296883e-02 
                                              ,-5.467705e-03,-1.986586e-02,2.714093e-03,8.048887e-01,1.610923e-02,-3.808554e-02 
                                              ,9.053337e-03,1.528048e-03,-2.219794e-03,8.571493e-03,8.915827e-01,-5.014806e-02 
                                              ,1.916188e-03,1.304791e-03,-5.892588e-05,-1.169294e-02,-1.636215e-02,9.044382e-01)</param> 

              <param name="r_leg_ft_sensor">(1.0,0.0,0.0,0.0,0.0,0.0,
                                             0.0,1.0,0.0,0.0,0.0,0.0,
                                             0.0,0.0,1.0,0.0,0.0,0.0,
                                             0.0,0.0,0.0,0.001,0.0,0.0,
                                             0.0,0.0,0.0,0.0,0.001,0.0,
                                             0.0,0.0,0.0,0.0,0.0,0.001)</param>
       </group> -->


<!--<group name="FT_TEMPERATURE_COEFFICIENTS">
              <param name="l_leg_ft_sensor">(-0.1025  ,  0.2960  ,  1.2987  , -0.0106 ,   0.0023  ,  0.0037 ,  30.4064)</param>
              <param name="r_leg_ft_sensor">(0.0,0.0,0.0,0.0,0.0,0.0,0.0)</param>
             <param name="l_foot_ft_sensor">(0.0,0.0,0.0,0.0,0.0,0.0,0.0)</param>
              <param name="r_foot_ft_sensor">(0.0,0.0,0.0,0.0,0.0,0.0,0.0)</param>
       </group> -->


     <!-- <group name="FT_OFFSET">
              <param name="l_leg_ft_sensor">(26.0163  , -9.5655 , -60.4540 ,  -0.2150   -0.2607  ,  0.1249)</param>   
              <param name="r_leg_ft_sensor">(0.0,0.0,0.0,0.0,0.0,0.0)</param>
       </group> -->

        <action phase="startup" level="15" type="attach">
            <paramlist name="networks">
                <!-- motorcontrol -->
                <elem name="left_leg">left_leg_mc</elem>
                <elem name="right_leg">right_leg_mc</elem>
                <elem name="torso">torso_mc</elem>
                <elem name="right_arm">right_arm_mc</elem>
                <elem name="left_arm">left_arm_mc</elem>
                <elem name="head">head_mc</elem>
                <!-- virtual torque sensors -->
                <!--<elem name="left_leg_vsens">left_leg_virtual_strain</elem>
                <elem name="right_leg_vsens">right_leg_virtual_strain</elem>
                <elem name="torso_vsens">torso_virtual_strain</elem>
                <elem name="right_arm_vsens">right_arm_virtual_strain</elem>
                <elem name="left_arm_vsens">left_arm_virtual_strain</elem>-->
                <!-- imu -->
                <elem name="imu">inertial</elem>
                <!-- ft -->
                <elem name="l_arm_ft_sensor">left_upper_arm_strain</elem>
                <elem name="r_arm_ft_sensor">right_upper_arm_strain</elem>
                <elem name="l_leg_ft_sensor">left_upper_leg_strain</elem>
                <elem name="r_leg_ft_sensor">right_upper_leg_strain</elem>
                <elem name="l_foot_ft_sensor">left_lower_leg_strain</elem>
                <elem name="r_foot_ft_sensor">right_lower_leg_strain</elem>
                <elem name="l_leg_ft_sensorMAS">left_upper_leg_strain2</elem>
                <elem name="r_leg_ft_sensorMAS">right_upper_leg_strain2</elem>
                <elem name="l_foot_ft_sensorMAS">left_lower_leg_strain2</elem>
                <elem name="r_foot_ft_sensorMAS">right_lower_leg_strain2</elem>
            </paramlist>
        </action>

        <action phase="shutdown" level="2" type="detach" />

    </device>
</devices>
